<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>代理受領通知書 自動作成ツール</title>
<script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:"Segoe UI","Yu Gothic UI","Meiryo",sans-serif;background:#f0f4f8;color:#1a202c;min-height:100vh}
.container{max-width:900px;margin:0 auto;padding:24px 16px}
h1{text-align:center;font-size:1.5rem;padding:20px 0;color:#2d3748}
h1 small{display:block;font-size:.75rem;color:#718096;font-weight:normal;margin-top:4px}
.step{background:#fff;border-radius:12px;padding:24px;margin-bottom:16px;box-shadow:0 1px 3px rgba(0,0,0,.1)}
.step-header{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.step-num{background:#4299e1;color:#fff;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.85rem;font-weight:bold;flex-shrink:0}
.step-num.done{background:#48bb78}
.step-title{font-size:1.05rem;font-weight:600}
.file-area{border:2px dashed #cbd5e0;border-radius:8px;padding:20px;text-align:center;cursor:pointer;transition:all .2s;margin-bottom:12px;position:relative}
.file-area:hover{border-color:#4299e1;background:#ebf8ff}
.file-area.loaded{border-color:#48bb78;border-style:solid;background:#f0fff4}
.file-area input[type="file"]{position:absolute;inset:0;opacity:0;cursor:pointer}
.file-area .icon{font-size:2rem;margin-bottom:8px}
.file-area .label{font-size:.9rem;color:#718096}
.file-area .loaded-info{font-size:.85rem;color:#2f855a;font-weight:600;margin-top:6px}
.form-grid{display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center}
.form-grid label{font-size:.9rem;font-weight:600;color:#4a5568}
.form-grid input,.form-grid select{padding:8px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:.9rem}
.form-grid input:focus,.form-grid select:focus{outline:none;border-color:#4299e1;box-shadow:0 0 0 3px rgba(66,153,225,.2)}
.data-table-wrap{max-height:400px;overflow-y:auto;border:1px solid #e2e8f0;border-radius:8px}
table{width:100%;border-collapse:collapse;font-size:.85rem}
thead{position:sticky;top:0;z-index:1}
th{background:#edf2f7;padding:10px 12px;text-align:left;font-weight:600;color:#4a5568;border-bottom:2px solid #cbd5e0}
td{padding:8px 12px;border-bottom:1px solid #edf2f7}
tr:hover td{background:#f7fafc}
.num{text-align:right;font-variant-numeric:tabular-nums}
.total-row td{font-weight:700;background:#edf2f7!important;border-top:2px solid #cbd5e0}
.btn-generate{display:block;width:100%;padding:14px;background:#4299e1;color:#fff;border:none;border-radius:8px;font-size:1.1rem;font-weight:700;cursor:pointer;transition:all .2s}
.btn-generate:hover:not(:disabled){background:#3182ce;transform:translateY(-1px);box-shadow:0 4px 12px rgba(66,153,225,.3)}
.btn-generate:disabled{background:#a0aec0;cursor:not-allowed}
.status{margin-top:12px;padding:12px 16px;border-radius:8px;font-size:.9rem;display:none}
.status.success{display:block;background:#f0fff4;color:#276749;border:1px solid #c6f6d5}
.status.error{display:block;background:#fff5f5;color:#9b2c2c;border:1px solid #fed7d7}
.status.info{display:block;background:#ebf8ff;color:#2b6cb0;border:1px solid #bee3f8}
.template-badge{display:inline-block;background:#48bb78;color:#fff;padding:2px 8px;border-radius:4px;font-size:.75rem;font-weight:600;margin-left:8px}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top-color:transparent;border-radius:50%;animation:spin .6s linear infinite;vertical-align:middle;margin-right:6px}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="container">
  <h1>代理受領通知書 自動作成ツール<small>CSVを読み込むだけで通知書Excelを一括生成（テンプレート内蔵）</small></h1>

  <div class="step">
    <div class="step-header">
      <div class="step-num" id="step1-num">1</div>
      <div class="step-title">CSVファイル選択 <span class="template-badge">テンプレート内蔵済</span></div>
    </div>
    <div class="file-area" id="csv-area">
      <input type="file" id="csv-input" accept=".csv,.CSV">
      <div class="icon">&#128196;</div>
      <div class="label">国保連CSVファイル（*.CSV）をクリックまたはドロップで選択</div>
      <div class="loaded-info" id="csv-info" style="display:none"></div>
    </div>
  </div>

  <div class="step">
    <div class="step-header">
      <div class="step-num" id="step2-num">2</div>
      <div class="step-title">基本情報入力</div>
    </div>
    <div class="form-grid">
      <label for="issue-date">発行日</label>
      <input type="text" id="issue-date" placeholder="例: 2026年02月24日">
      <label for="receipt-date">受給日</label>
      <div style="display:flex;gap:8px;align-items:center;">
        <input type="date" id="receipt-date-picker">
        <input type="text" id="receipt-date" placeholder="例: 令和7年11月20日" style="flex:1;">
      </div>
      <label for="service-type">サービス種別</label>
      <div style="display:flex;gap:8px;">
        <select id="service-select" style="flex:1;">
          <option value="">--- CSVから自動判定 ---</option>
          <option value="共同生活援助">共同生活援助</option>
          <option value="短期入所">短期入所</option>
          <option value="生活介護">生活介護</option>
          <option value="就労継続支援Ａ型">就労継続支援Ａ型</option>
          <option value="就労継続支援Ｂ型">就労継続支援Ｂ型</option>
          <option value="就労移行支援">就労移行支援</option>
          <option value="居宅介護">居宅介護</option>
          <option value="__custom__">その他（手入力）</option>
        </select>
        <input type="text" id="service-custom" placeholder="手入力" style="flex:1;display:none;">
      </div>
    </div>
  </div>

  <div class="step" id="step3" style="display:none;">
    <div class="step-header">
      <div class="step-num" id="step3-num">3</div>
      <div class="step-title">データ確認 (<span id="data-count">0</span>件)</div>
    </div>
    <div class="data-table-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>受給者番号</th>
            <th>氏名</th>
            <th>対象月</th>
            <th class="num">総費用額</th>
            <th class="num">利用者負担額</th>
            <th class="num">代理受領額</th>
            <th class="num">特定障害者給付費</th>
          </tr>
        </thead>
        <tbody id="data-tbody"></tbody>
      </table>
    </div>
  </div>

  <div class="step">
    <button class="btn-generate" id="btn-generate" disabled>Excel出力</button>
    <div class="status" id="status"></div>
  </div>
</div>

<script>
// ==== Embedded template ====
var TEMPLATE_B64 = "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";

// ==== State ====
var csvData = [];
var templateBuffer = null;

// ==== Service code master (障害福祉サービス種類コード) ====
var SERVICE_NAMES = {
  "11": "\u5c45\u5b85\u4ecb\u8b77",
  "12": "\u91cd\u5ea6\u8a2a\u554f\u4ecb\u8b77",
  "13": "\u540c\u884c\u63f4\u8b77",
  "14": "\u884c\u52d5\u63f4\u8b77",
  "21": "\u77ed\u671f\u5165\u6240",
  "22": "\u751f\u6d3b\u4ecb\u8b77",
  "23": "\u65bd\u8a2d\u5165\u6240\u652f\u63f4",
  "24": "\u77ed\u671f\u5165\u6240",
  "31": "\u5c31\u52b4\u79fb\u884c\u652f\u63f4",
  "32": "\u5c31\u52b4\u7d99\u7d9a\u652f\u63f4\uff21\u578b",
  "33": "\u5171\u540c\u751f\u6d3b\u63f4\u52a9",
  "34": "\u5c31\u52b4\u5b9a\u7740\u652f\u63f4",
  "35": "\u5c31\u52b4\u9078\u629e\u652f\u63f4",
  "36": "\u81ea\u7acb\u8a13\u7df4\uff08\u751f\u6d3b\u8a13\u7df4\uff09",
  "43": "\u5171\u540c\u751f\u6d3b\u63f4\u52a9",
  "51": "\u5c31\u52b4\u7d99\u7d9a\u652f\u63f4\uff22\u578b",
  "65": "\u77ed\u671f\u5165\u6240"
};

// ==== 市町村番号マスタ（先頭5桁で照合） ====
var MUNICIPALITY_CODES = {
  // 愛知県 - 名古屋市
  "23101":"名古屋市千種区","23102":"名古屋市東区","23103":"名古屋市北区","23104":"名古屋市西区",
  "23105":"名古屋市中村区","23106":"名古屋市中区","23107":"名古屋市昭和区","23108":"名古屋市瑞穂区",
  "23109":"名古屋市熱田区","23110":"名古屋市中川区","23111":"名古屋市港区","23112":"名古屋市南区",
  "23113":"名古屋市守山区","23114":"名古屋市緑区","23115":"名古屋市名東区","23116":"名古屋市天白区",
  // 愛知県 - 市部
  "23201":"豊橋市","23202":"岡崎市","23203":"一宮市","23204":"瀬戸市","23205":"半田市",
  "23206":"春日井市","23207":"豊川市","23208":"津島市","23209":"碧南市","23210":"刈谷市",
  "23211":"豊田市","23212":"安城市","23213":"西尾市","23214":"蒲郡市","23215":"犬山市",
  "23216":"常滑市","23217":"江南市","23219":"小牧市","23220":"稲沢市","23221":"新城市",
  "23222":"東海市","23223":"大府市","23224":"知多市","23225":"知立市","23226":"尾張旭市",
  "23227":"高浜市","23228":"岩倉市","23229":"豊明市","23230":"日進市","23231":"田原市",
  "23232":"愛西市","23233":"清須市","23234":"北名古屋市","23235":"弥富市","23236":"みよし市",
  "23237":"あま市","23238":"長久手市",
  // 愛知県 - 郡部
  "23302":"東郷町","23342":"豊山町","23362":"扶桑町","23424":"大治町","23425":"蟹江町",
  "23427":"飛島村","23441":"阿久比町","23442":"東浦町","23445":"南知多町","23446":"美浜町",
  "23447":"武豊町","23501":"幸田町","23561":"設楽町","23562":"東栄町","23563":"豊根村",
  // 東京都 - 主要市部
  "13201":"八王子市","13202":"立川市","13203":"武蔵野市","13204":"三鷹市","13205":"青梅市",
  "13206":"府中市","13207":"昭島市","13208":"調布市","13209":"町田市","13210":"小金井市",
  "13211":"小平市","13212":"日野市","13213":"東村山市","13214":"国分寺市","13215":"国立市",
  "13218":"福生市","13219":"狛江市","13220":"東大和市","13221":"清瀬市","13222":"東久留米市",
  "13223":"武蔵村山市","13224":"多摩市","13225":"稲城市","13227":"西東京市"
};

// ==== Init ====
document.addEventListener("DOMContentLoaded", function() {
  // Decode embedded template
  var binaryStr = atob(TEMPLATE_B64);
  var bytes = new Uint8Array(binaryStr.length);
  for (var i = 0; i < binaryStr.length; i++) bytes[i] = binaryStr.charCodeAt(i);
  templateBuffer = bytes.buffer;

  // Default issue date
  var now = new Date();
  document.getElementById("issue-date").value =
    now.getFullYear() + "\u5e74" + String(now.getMonth()+1).padStart(2,"0") + "\u6708" + String(now.getDate()).padStart(2,"0") + "\u65e5";

  document.getElementById("service-select").addEventListener("change", function(e) {
    document.getElementById("service-custom").style.display = e.target.value === "__custom__" ? "" : "none";
  });
  document.getElementById("csv-input").addEventListener("change", handleCsvFile);
  document.getElementById("btn-generate").addEventListener("click", generateExcel);
  document.getElementById("receipt-date-picker").addEventListener("change", function() {
    var val = this.value;
    if (!val) return;
    var d = new Date(val);
    var y = d.getFullYear(), m = d.getMonth() + 1, day = d.getDate();
    var wareki = "";
    if (y >= 2019) { wareki = "令和" + ((y - 2018) === 1 ? "元" : (y - 2018)) + "年" + m + "月" + day + "日"; }
    else if (y >= 1989) { wareki = "平成" + ((y - 1988) === 1 ? "元" : (y - 1988)) + "年" + m + "月" + day + "日"; }
    else { wareki = y + "年" + m + "月" + day + "日"; }
    document.getElementById("receipt-date").value = wareki;
  });
});

// ==== CSV Parsing ====
function handleCsvFile(e) {
  var file = e.target.files[0];
  if (!file) return;
  var reader = new FileReader();
  reader.onload = function(ev) {
    try {
      var text = decodeShiftJIS(new Uint8Array(ev.target.result));
      csvData = parseCsv(text);
      document.getElementById("csv-area").classList.add("loaded");
      var info = document.getElementById("csv-info");
      info.style.display = "";
      info.textContent = "\u2714 " + file.name + " \u8aad\u8fbc\u6e08 (" + csvData.length + "\u4ef6)";
      document.getElementById("step1-num").classList.add("done");
      renderDataTable();
      updateGenerateButton();
    } catch(err) {
      showStatus("error", "CSV\u8aad\u307f\u8fbc\u307f\u30a8\u30e9\u30fc: " + err.message);
    }
  };
  reader.readAsArrayBuffer(file);
}

function decodeShiftJIS(uint8arr) {
  try { return new TextDecoder("shift_jis").decode(uint8arr); }
  catch(e) { return new TextDecoder("utf-8").decode(uint8arr); }
}

function parseCsv(text) {
  var lines = text.split(/\r?\n/);
  var users = {};
  for (var li = 0; li < lines.length; li++) {
    var line = lines[li];
    if (!line.trim()) continue;
    var row = parseCSVLine(line);
    if (row.length < 3) continue;
    var recordId = row[2], subType = row.length > 3 ? row[3] : "";

    if ((recordId === "J131" || recordId === "J121") && subType === "01") {
      var userId = (row[7] || "").trim();
      var kanaName = (row[9] || "").trim();
      var targetMonth = (row[4] || "").trim();
      var municipalityCode = (row[5] || "").trim();
      var serviceCost = parseInt(row[22], 10) || 0;
      var userBurden  = parseInt(row[23], 10) || 0;
      var proxyAmount = parseInt(row[29], 10) || 0;
      var specGrant   = parseInt(row[35], 10) || 0;

      var key = userId + "_" + targetMonth;
      if (!users[key]) {
        users[key] = { userId: userId, name: kanaName, month: targetMonth,
          municipalityCode: municipalityCode, serviceCost: serviceCost,
          userBurden: userBurden, proxyAmount: proxyAmount, specGrant: specGrant,
          serviceCode: "" };
      } else {
        users[key].serviceCost += serviceCost;
        users[key].userBurden  += userBurden;
        users[key].proxyAmount += proxyAmount;
        users[key].specGrant   += specGrant;
      }
    }

    // J131/J121 type 02: service TYPE code (2-digit, e.g. "33" = 共同生活援助)
    if ((recordId === "J131" || recordId === "J121") && subType === "02") {
      var uid2 = (row[7] || "").trim();
      var mon2 = (row[4] || "").trim();
      var sc2 = (row[8] || "").trim();
      var k2 = uid2 + "_" + mon2;
      if (users[k2]) users[k2].serviceCode = sc2;
    }
  }
  return Object.values(users);
}

function parseCSVLine(line) {
  var result = [], current = "", inQuotes = false;
  for (var i = 0; i < line.length; i++) {
    var ch = line[i];
    if (inQuotes) {
      if (ch === '"') {
        if (i + 1 < line.length && line[i + 1] === '"') { current += '"'; i++; }
        else inQuotes = false;
      } else current += ch;
    } else {
      if (ch === '"') inQuotes = true;
      else if (ch === ",") { result.push(current); current = ""; }
      else current += ch;
    }
  }
  result.push(current);
  return result;
}

// ==== Data Table ====
function renderDataTable() {
  var tbody = document.getElementById("data-tbody");
  tbody.innerHTML = "";
  if (csvData.length === 0) { document.getElementById("step3").style.display = "none"; return; }
  document.getElementById("step3").style.display = "";
  document.getElementById("data-count").textContent = csvData.length;

  var tC = 0, tB = 0, tP = 0, tS = 0;
  for (var i = 0; i < csvData.length; i++) {
    var d = csvData[i];
    tC += d.serviceCost; tB += d.userBurden; tP += d.proxyAmount; tS += d.specGrant;
    var tr = document.createElement("tr");
    tr.innerHTML = "<td>" + (i+1) + "</td><td>" + esc(d.userId) + "</td><td>" + esc(d.name) +
      "</td><td>" + esc(formatMonth(d.month)) + "</td><td class=num>" + fmtNum(d.serviceCost) +
      "</td><td class=num>" + fmtNum(d.userBurden) + "</td><td class=num>" + fmtNum(d.proxyAmount) +
      "</td><td class=num>" + fmtNum(d.specGrant) + "</td>";
    tbody.appendChild(tr);
  }
  var tt = document.createElement("tr"); tt.className = "total-row";
  tt.innerHTML = "<td></td><td></td><td>\u5408\u8a08</td><td></td><td class=num>" + fmtNum(tC) +
    "</td><td class=num>" + fmtNum(tB) + "</td><td class=num>" + fmtNum(tP) +
    "</td><td class=num>" + fmtNum(tS) + "</td>";
  tbody.appendChild(tt);
  document.getElementById("step3-num").classList.add("done");
}

// ==== Excel Generation ====
async function generateExcel() {
  if (csvData.length === 0 || !templateBuffer) return;
  var btn = document.getElementById("btn-generate");
  btn.disabled = true;
  btn.innerHTML = "<span class=spinner></span>\u751f\u6210\u4e2d...";
  showStatus("info", "Excel\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059...");

  try {
    var issueDate = document.getElementById("issue-date").value;
    var receiptDate = document.getElementById("receipt-date").value;
    var serviceSelect = document.getElementById("service-select").value;
    var serviceCustom = document.getElementById("service-custom").value;
    var serviceNameOverride = serviceSelect === "__custom__" ? serviceCustom : (serviceSelect || "");

    var wb = new ExcelJS.Workbook();
    await wb.xlsx.load(templateBuffer);

    // FIX: Set default font to Yu Gothic (matching template)
    wb.properties = wb.properties || {};

    var userMasters = extractUserMasters(wb);
    var sourceSheet = wb.getWorksheet("\u539f\u672c") || wb.worksheets[0];

    // FIX: Resolve H15-H19 company values (some may be formulas referencing other sheets)
    // We need to read from 事業者情報 sheet directly for formula cells
    var companyVals = {};
    var bizSheet = wb.getWorksheet("\u4e8b\u696d\u8005\u60c5\u5831");
    for (var r = 15; r <= 19; r++) {
      var cellVal = sourceSheet.getCell("H" + r).value;
      // If cell is a formula object, resolve it manually from 事業者情報
      if (cellVal && typeof cellVal === "object" && cellVal.formula) {
        cellVal = resolveCompanyFormula(cellVal.formula, bizSheet);
      }
      companyVals["H" + r] = cellVal;
    }

    // FIX: Save border styles from template for E26:H28 range (right border fix)
    var borderTemplates = {};
    ["E26","E27","E28","H26","H27","H28"].forEach(function(addr) {
      var c = sourceSheet.getCell(addr);
      if (c.style && c.style.border) {
        borderTemplates[addr] = JSON.parse(JSON.stringify(c.style.border));
      }
    });

    // FIX: Save E8 style for vertical alignment
    var e8Style = sourceSheet.getCell("E8").style ?
      JSON.parse(JSON.stringify(sourceSheet.getCell("E8").style)) : null;

    var sheetCount = 0;
    for (var di = 0; di < csvData.length; di++) {
      var data = csvData[di];
      var userId = String(data.userId).trim();

      // Lookup with ID normalization
      var kanjiName = "", municipality = "";
      var me = userMasters[userId] || userMasters[userId.replace(/^0+/, "")];
      if (me) { kanjiName = me.kanjiName || ""; municipality = me.municipality || ""; }
      // 受給者情報に未登録の場合、CSVの市町村番号から自動変換
      if (!municipality && data.municipalityCode) {
        municipality = MUNICIPALITY_CODES[data.municipalityCode.substring(0, 5)] || "";
      }
      // 漢字名が数値のみの場合は無効とみなしCSVのカナ名を使う
      if (/^\d+$/.test(kanjiName)) kanjiName = "";
      var displayName = kanjiName || data.name;

      var safeName = displayName.replace(/[:\\\/\?\*\[\]]/g, "").substring(0, 31);
      if (!safeName) safeName = "User_" + sheetCount;

      var finalName = safeName, suffix = 2;
      while (wb.getWorksheet(finalName)) { finalName = safeName.substring(0, 28) + "_" + suffix; suffix++; }

      var ns = wb.addWorksheet(finalName);
      copySheetStructure(sourceSheet, ns);

      // === CORRECT cell mapping (matching template layout) ===
      ns.getCell("D7").value = userId;
      ns.getCell("D8").value = displayName;
      ns.getCell("H4").value = "\u767a\u884c\u65e5: " + issueDate;

      // Row 23: year, Row 24: month + proxy amount
      var monthStr = data.month;
      if (monthStr && monthStr.length === 6) {
        ns.getCell("C23").value = parseInt(monthStr.substring(0, 4), 10);  // 年（変数）
        ns.getCell("D23").value = "年";
        ns.getCell("C24").value = parseInt(monthStr.substring(4), 10);     // 月
      }
      ns.getCell("F24").value = { formula: "H30-H31+H32" };

      // Row 26-28
      ns.getCell("E26").value = municipality;

      var serviceName = serviceNameOverride;
      if (!serviceName) {
        var rawCode = data.serviceCode || "";
        serviceName = SERVICE_NAMES[rawCode] || SERVICE_NAMES[rawCode.substring(0, 2)] || rawCode;
      }
      ns.getCell("E27").value = serviceName;
      ns.getCell("E28").value = receiptDate;

      // Row 29-33: financial data
      ns.getCell("H29").value = data.serviceCost;  // 総支給額（単位）
      ns.getCell("H30").value = data.serviceCost;  // 総サービス費(A)
      ns.getCell("H31").value = data.userBurden;   // 利用者負担額(B)
      ns.getCell("H32").value = data.specGrant;    // 特定障害者給付費(C)
      ns.getCell("H33").value = { formula: "H30-H31+H32" };  // 合計 = A - B + C

      // FIX: Company info - write resolved values (not formulas)
      for (var cr = 15; cr <= 19; cr++) ns.getCell("H" + cr).value = companyVals["H" + cr];

      // FIX: Restore right borders on E26:H28
      ["E26","E27","E28","H26","H27","H28"].forEach(function(addr) {
        if (borderTemplates[addr]) {
          var cell = ns.getCell(addr);
          var st = cell.style ? JSON.parse(JSON.stringify(cell.style)) : {};
          st.border = borderTemplates[addr];
          cell.style = st;
        }
      });

      // FIX: Restore E8 vertical alignment
      if (e8Style) {
        ns.getCell("E8").style = JSON.parse(JSON.stringify(e8Style));
      }

      // B21: フォントサイズを12に変更
      var b21 = ns.getCell("B21");
      var b21Style = b21.style ? JSON.parse(JSON.stringify(b21.style)) : {};
      if (!b21Style.font) b21Style.font = {};
      b21Style.font.size = 12;
      b21.style = b21Style;

      // FIX: Correct print settings (remove fitToWidth/fitToHeight)
      if (ns.pageSetup) {
        delete ns.pageSetup.fitToWidth;
        delete ns.pageSetup.fitToHeight;
      }

      // FIX: Set default font for all cells to Yu Gothic
      ns.eachRow(function(row) {
        row.eachCell(function(cell) {
          if (cell.style) {
            var s = JSON.parse(JSON.stringify(cell.style));
            if (!s.font) s.font = {};
            if (!s.font.name || s.font.name === "Calibri") s.font.name = "\u6e38\u30b4\u30b7\u30c3\u30af";
            cell.style = s;
          }
        });
      });

      sheetCount++;
    }

    // Remove master sheets
    ["\u539f\u672c", "\u4e8b\u696d\u8005\u60c5\u5831", "\u53d7\u7d66\u8005\u60c5\u5831", "Sheet1"].forEach(function(name) {
      var ws = wb.getWorksheet(name);
      if (ws) wb.removeWorksheet(ws.id);
    });

    var buf = await wb.xlsx.writeBuffer();
    var blob = new Blob([buf], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
    var now = new Date();
    var ts = now.getFullYear() + String(now.getMonth()+1).padStart(2,"0") + String(now.getDate()).padStart(2,"0") +
      "_" + String(now.getHours()).padStart(2,"0") + String(now.getMinutes()).padStart(2,"0") + String(now.getSeconds()).padStart(2,"0");
    saveAs(blob, "\u4ee3\u7406\u53d7\u9818\u901a\u77e5\u66f8_\u4e00\u62ec\u51fa\u529b_" + ts + ".xlsx");

    showStatus("success", "\u2714 " + sheetCount + "\u540d\u5206\u306eExcel\u3092\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002");
  } catch(err) {
    showStatus("error", "\u30a8\u30e9\u30fc: " + err.message);
    console.error(err);
  } finally {
    btn.disabled = false;
    btn.textContent = "Excel\u51fa\u529b";
    updateGenerateButton();
  }
}

// ==== Resolve company formula (H17-H19 reference 事業者情報 sheet) ====
function resolveCompanyFormula(formula, bizSheet) {
  // Handle formulas like: 事業者情報!C5&"　"&事業者情報!C6
  // or: 事業者情報!C7&""
  if (!bizSheet) return "";
  var parts = formula.split("&");
  var result = "";
  for (var i = 0; i < parts.length; i++) {
    var p = parts[i].trim();
    // Match cell reference like 事業者情報!C5
    var m = p.match(/!([A-Z]+)(\d+)/);
    if (m) {
      var cellAddr = m[1] + m[2];
      var val = bizSheet.getCell(cellAddr).value;
      result += (val !== null && val !== undefined) ? String(val) : "";
    } else {
      // Literal string like "　" or ""
      var sm = p.match(/^"(.*)"$/);
      if (sm) result += sm[1];
    }
  }
  return result;
}

// ==== Extract user masters with ID normalization ====
function extractUserMasters(wb) {
  var masters = {};
  var ws = wb.getWorksheet("\u53d7\u7d66\u8005\u60c5\u5831");
  if (!ws) return masters;

  function addM(row, mc, uc, nc) {
    var muni = getCellText(ws, row, mc);
    var uid = getCellText(ws, row, uc);
    var name = getCellText(ws, row, nc);
    if (uid) {
      masters[uid] = { municipality: muni, kanjiName: name };
      var padded = uid.padStart(10, "0");
      if (padded !== uid) masters[padded] = { municipality: muni, kanjiName: name };
    }
  }

  for (var r = 3; r <= 30; r++) { addM(r, 1, 2, 3); addM(r, 5, 6, 7); }
  return masters;
}

function getCellText(ws, row, col) {
  var val = ws.getCell(row, col).value;
  if (val === null || val === undefined) return "";
  return String(val).trim();
}

// ==== Copy sheet structure ====
function copySheetStructure(src, dst) {
  if (src.columns) {
    src.columns.forEach(function(col, i) {
      if (col && col.width) dst.getColumn(i + 1).width = col.width;
    });
  }
  src.eachRow({ includeEmpty: true }, function(srcRow, rowNum) {
    var dstRow = dst.getRow(rowNum);
    dstRow.height = srcRow.height;
    srcRow.eachCell({ includeEmpty: true }, function(srcCell, colNum) {
      var dstCell = dstRow.getCell(colNum);
      dstCell.value = srcCell.value;
      if (srcCell.style) { try { dstCell.style = JSON.parse(JSON.stringify(srcCell.style)); } catch(e) {} }
    });
    dstRow.commit();
  });
  if (src._merges) {
    Object.keys(src._merges).forEach(function(key) {
      try { var m = src._merges[key]; dst.mergeCells(m.range || m); } catch(e) {}
    });
  }
  if (src.pageSetup) { try { dst.pageSetup = JSON.parse(JSON.stringify(src.pageSetup)); } catch(e) {} }
}

// ==== Helpers ====
function formatMonth(ym) { return (!ym || ym.length !== 6) ? ym : ym.substring(0,4) + "/" + ym.substring(4); }
function fmtNum(n) { return n.toLocaleString("ja-JP"); }
function esc(s) { if (!s) return ""; var el = document.createElement("span"); el.textContent = s; return el.innerHTML; }
function updateGenerateButton() { document.getElementById("btn-generate").disabled = !(csvData.length > 0 && templateBuffer); }
function showStatus(type, msg) { var el = document.getElementById("status"); el.className = "status " + type; el.textContent = msg; }
</script>
</body>
</html>